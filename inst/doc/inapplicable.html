<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Martin R. Smith" />

<meta name="date" content="2020-06-09" />

<title>Inapplicable data in morphological phylogenetics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Inapplicable data in morphological phylogenetics</h1>
<h4 class="author">Martin R. Smith</h4>
<h4 class="date">2020-06-09</h4>



<p><code>TreeSearch</code> is an R package that allows, among other things, parsimony search on morphological datasets that contain inapplicable data, following the algorithm proposed by Brazeau, Guillerme and Smith <span class="citation">(2019)</span>.</p>
<p>In brief, this algorithm modifies the Fitch algorithm to count the total number of homoplasious events on a tree.</p>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p><a href="getting-started.html">A companion vignette</a> gives details on installing the package and getting up and running.</p>
<p>Once installed, load the TreeSearch package into R using</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&#39;TreeSearch&#39;</span>)</span></code></pre></div>
</div>
<div id="scoring-a-tree-and-conducting-a-tree-search" class="section level2">
<h2>Scoring a tree, and conducting a tree search</h2>
<p>Here’s an example of using the package to conduct tree search. You can <a href="https://ms609.github.io/TreeTools/articles/load-data.html">load your own dataset</a>, but for now, we’ll use the Vinther <em>et al.</em> <span class="citation">(2008)</span> dataset that comes bundled with the package.</p>
<p>This dataset is small enough that it runs reasonably quickly, but its phylogenetic signal is obscure enough that it can require Ratchet searches to escape from local optima.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>my.data &lt;-<span class="st"> </span>TreeSearch<span class="op">::</span>inapplicable.datasets[[<span class="st">&#39;Vinther2008&#39;</span>]]</span>
<span id="cb2-2"><a href="#cb2-2"></a>my.phyDat &lt;-<span class="st"> </span>phangorn<span class="op">::</span><span class="kw">phyDat</span>(my.data, <span class="dt">type =</span> <span class="st">&#39;USER&#39;</span>, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">9</span>, <span class="st">&#39;-&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Set a random seed so that random functions in this document are reproducible</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">suppressWarnings</span>(<span class="kw">RNGversion</span>(<span class="st">&quot;3.5.0&quot;</span>)) <span class="co"># Until we can require R3.6.0</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span></code></pre></div>
<p>We can generate a random tree and calculate its parsimony score thus:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>random.tree &lt;-<span class="st"> </span>TreeTools<span class="op">::</span><span class="kw">RandomTree</span>(my.phyDat, <span class="dt">root =</span> <span class="ot">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">plot</span>(random.tree)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">Fitch</span>(random.tree, my.phyDat)</span></code></pre></div>
<pre><code>## [1] 189</code></pre>
<p>We might save some wasted time in tree search if we can start with a tree that’s a little closer to optimal: perhaps a neighbour-joining tree.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>nj.tree &lt;-<span class="st"> </span>TreeTools<span class="op">::</span><span class="kw">NJTree</span>(my.phyDat)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">plot</span>(nj.tree)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">Fitch</span>(nj.tree, my.phyDat)</span></code></pre></div>
<pre><code>## [1] 85</code></pre>
<p>With the Vinther <em>et al.</em> <span class="citation">(2008)</span> dataset, nemerteans and brachiopods form an natural outgroup to the other taxa. If we wish, we can constrain this outgroup and avoid making tree rearrangements that would mix ingroup and outgroup taxa. This will accelerate tree search, but it’s worth thinking carefully whether you can be perfectly confident that the ingroup and outgroup are mutually monophyletic.</p>
<p>To constrain an outgroup, we first need to make the outgroup and ingroup monophyletic on our tree:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>outgroup &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Nemertean&#39;</span>, <span class="st">&#39;Lingula&#39;</span>, <span class="st">&#39;Terebratulina&#39;</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>rooted.tree &lt;-<span class="st"> </span>TreeTools<span class="op">::</span><span class="kw">EnforceOutgroup</span>(nj.tree, outgroup)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">plot</span>(rooted.tree)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now let’s see whether a few nearest-neighbour interchanges can find us a better tree score. This tends to be the quickest search to run, if not the most exhaustive. Using <code>RootedNNISwap</code> instead of <code>NNISwap</code> stops taxa from moving from one side of the root to another, which we need to do if we’re going to enforce our outgroup constraint. Even if we are using a single-taxon outgroup, using <code>RootedNNISwap</code> retains the position of the root, which makes tree comparison and interpretation easier later on.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>better.tree &lt;-<span class="st"> </span><span class="kw">TreeSearch</span>(<span class="dt">tree =</span> rooted.tree, <span class="dt">dataset =</span> my.phyDat, </span>
<span id="cb11-2"><a href="#cb11-2"></a>                           <span class="dt">EdgeSwapper =</span> RootedNNISwap, <span class="dt">verbosity =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   - Performing tree search.  Initial score: 85</code></pre>
<pre><code>##     - Iteration 1 - Best score 85 hit 1 times.</code></pre>
<pre><code>##     - Iteration 3 - Best score 85 hit 2 times.</code></pre>
<pre><code>##     - Iteration 4 - Best score 85 hit 3 times.</code></pre>
<pre><code>##     - Iteration 5 - Best score 85 hit 4 times.</code></pre>
<pre><code>##     - Iteration 8 - Best score 85 hit 5 times.</code></pre>
<pre><code>##     - Iteration 10 - Best score 85 hit 6 times.</code></pre>
<pre><code>##     - Iteration 11 - Best score 85 hit 7 times.</code></pre>
<pre><code>##     - Iteration 13 - Best score 85 hit 8 times.</code></pre>
<pre><code>##     - Iteration 14 - Best score 85 hit 9 times.</code></pre>
<pre><code>##     - Iteration 16 - Best score 85 hit 10 times.</code></pre>
<pre><code>##     * Iteration 18 - New best score 84 found on 1 trees.</code></pre>
<pre><code>##     - Iteration 20 - Best score 84 hit 2 times.</code></pre>
<pre><code>##     - Iteration 23 - Best score 84 hit 3 times.</code></pre>
<pre><code>##     - Iteration 24 - Best score 84 hit 4 times.</code></pre>
<pre><code>##     - Iteration 25 - Best score 84 hit 5 times.</code></pre>
<pre><code>##     * Iteration 27 - New best score 82 found on 1 trees.</code></pre>
<pre><code>##     - Iteration 29 - Best score 82 hit 2 times.</code></pre>
<pre><code>##     - Iteration 34 - Best score 82 hit 3 times.</code></pre>
<pre><code>##     - Iteration 37 - Best score 82 hit 4 times.</code></pre>
<pre><code>##     * Iteration 42 - New best score 81 found on 1 trees.</code></pre>
<pre><code>##     * Iteration 45 - New best score 80 found on 1 trees.</code></pre>
<pre><code>##     - Iteration 59 - Best score 80 hit 2 times.</code></pre>
<pre><code>##     - Iteration 65 - Best score 80 hit 3 times.</code></pre>
<pre><code>##     - Iteration 67 - Best score 80 hit 4 times.</code></pre>
<pre><code>##     - Iteration 68 - Best score 80 hit 5 times.</code></pre>
<pre><code>##     - Iteration 71 - Best score 80 hit 6 times.</code></pre>
<pre><code>##     - Iteration 90 - Best score 80 hit 7 times.</code></pre>
<pre><code>##     - Iteration 93 - Best score 80 hit 8 times.</code></pre>
<pre><code>##   - Final score 80 found 8 times after 100 rearrangements.</code></pre>
<p>This score is better than the 85 of the original neighbour-joining tree, but is this the best we can do?</p>
<p>Using NNI helps to explore the region of treespace close to the local optimum, but SPR and TBR rearrangements are better at escaping local optima, and find better trees further away in tree space. Using more hits (<code>maxHits</code>) and more iterations (<code>maxIter</code>) also means we’ll move closer to an optimal tree.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>better.tree &lt;-<span class="st"> </span><span class="kw">TreeSearch</span>(better.tree, my.phyDat, <span class="dt">maxHits =</span> <span class="dv">8</span>, <span class="dt">maxIter =</span> <span class="dv">10000</span>,</span>
<span id="cb42-2"><a href="#cb42-2"></a>                           <span class="dt">EdgeSwapper=</span>RootedSPRSwap, <span class="dt">verbosity =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   - Performing tree search.  Initial score: 80</code></pre>
<pre><code>##   - Terminating search; hit best score 8 times.</code></pre>
<pre><code>##   - Final score 80 found 8 times after 360 rearrangements.</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>better.tree &lt;-<span class="st"> </span><span class="kw">TreeSearch</span>(better.tree, my.phyDat, <span class="dt">maxHits =</span> <span class="dv">20</span>, <span class="dt">maxIter =</span> <span class="dv">40000</span>, </span>
<span id="cb46-2"><a href="#cb46-2"></a>                           <span class="dt">EdgeSwapper=</span>RootedTBRSwap, <span class="dt">verbosity =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   - Performing tree search.  Initial score: 80</code></pre>
<pre><code>##   - Terminating search; hit best score 20 times.</code></pre>
<pre><code>##   - Final score 80 found 20 times after 782 rearrangements.</code></pre>
<p>That score’s looking better, but these are only quick searches, and we could be caught in a local optimum. A more comprehensive search of tree space can be accomplished using the parsimony ratchet <span class="citation">(Nixon, 1999)</span>. It might take a couple of minutes to run with the default parameters.<br />
To be confident that you have found a globally optimum tree, it’s worth running a ratchet with verbosity = 2 and following the search, increasing <code>ratchIter</code> and other search parameters until you are confident that independent ratchet iterations are consistently converging on the optimum score.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>best.tree &lt;-<span class="st"> </span><span class="kw">Ratchet</span>(better.tree, my.phyDat, <span class="dt">verbosity=</span><span class="dv">0</span>, <span class="dt">ratchIter=</span><span class="dv">5</span>,</span>
<span id="cb50-2"><a href="#cb50-2"></a>                     <span class="dt">swappers=</span><span class="kw">list</span>(RootedTBRSwap, RootedSPRSwap, RootedNNISwap))</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="kw">attr</span>(best.tree, <span class="st">&#39;score&#39;</span>) <span class="co"># Each tree is labelled with its score during tree search</span></span></code></pre></div>
<pre><code>## [1] 79</code></pre>
<p>The best tree for this dataset has a score of 79. This relatively quick Ratchet search always seems to find a tree with this score from this dataset. (Larger datasets will probably need a more exhaustive search.)</p>
<p>Let’s take a look at the one it’s found on this occasion:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">plot</span>(best.tree)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This is, of course, just one most parsimonious tree; with this dataset, there are many.</p>
<p>One way to make a strict consensus of multiple optimal trees is to collect a number of trees from independent Ratchet iterations.</p>
<p>For each Ratchet iteration, we’ll conduct a TBR search to scan tree space, then an NNI search to hone in on the local optimum.</p>
<p>Note that it’s especially important to retain the position of the root here: a single topology, if rooted in different places, can lead to an unresolved consensus.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>some.optimal.trees &lt;-<span class="st"> </span><span class="kw">MultiRatchet</span>(best.tree, <span class="dt">nSearch =</span> <span class="dv">20</span>, my.phyDat,</span>
<span id="cb53-2"><a href="#cb53-2"></a>                                   <span class="dt">swappers =</span> </span>
<span id="cb53-3"><a href="#cb53-3"></a>                                   <span class="kw">list</span>(RootedTBRSwap, RootedNNISwap))</span></code></pre></div>
<pre><code>## Found 11 unique trees from 20 searches.</code></pre>
<p>If ten independent runs ended up at a number of different trees, there may be many more optimal trees out there to be found; perhaps we could repeat <code>MultiRatchet</code> with <code>nSearch = 250</code> for a more exhaustive sampling of tree space. That would take a while though; for now, let’s check out our consensus tree:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>strict.consensus &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">consensus</span>(some.optimal.trees)</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="kw">plot</span>(strict.consensus)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We might prefer a majority-rule consensus tree:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex=</span><span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>majority.consensus &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">consensus</span>(some.optimal.trees, <span class="dt">p =</span> <span class="fl">0.5</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="kw">plot</span>(majority.consensus)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Clade support can be generated using Jackknife resampling:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>jack.trees &lt;-<span class="st"> </span><span class="kw">Jackknife</span>(best.tree, my.phyDat, <span class="dt">EdgeSwapper =</span> RootedTBRSwap,</span>
<span id="cb57-2"><a href="#cb57-2"></a>                        <span class="dt">jackIter =</span> <span class="dv">20</span>, <span class="dt">verbosity =</span> <span class="dv">0</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb57-4"><a href="#cb57-4"></a></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="kw">JackLabels</span>(strict.consensus, jack.trees) -&gt;<span class="st"> </span>XX</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="implied-weighting" class="section level2">
<h2>Implied weighting</h2>
<p>Equal weights produces trees that are less accurate and less precise than implied weights <span class="citation">(Smith, 2019)</span>; equally weighted analysis should never be conducted without also considering the results of implied weights <span class="citation">(Goloboff, 1997)</span>, ideally under a range of concavity constants <span class="citation">(cf. Smith &amp; Ortega-Hernández, 2014)</span>.</p>
<p>The simplest way to conduct an implied weights search is to use the functions</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>IWTreeSearch</span>
<span id="cb58-2"><a href="#cb58-2"></a>IWRatchet</span>
<span id="cb58-3"><a href="#cb58-3"></a>IWMultiRatchet</span></code></pre></div>
<p>which operate in the same fashion as their equally-weighted counterparts, with the option of specifying a concavity constant (<em>k</em>) using the parameter <code>concavity=k</code> (default = 10). Note that the default value of 10 is somewhat higher than the default of 3 in TNT; this low default probably gives poorer results in many settings <span class="citation">(Smith, 2019)</span>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-Brazeau2018">
<p>Brazeau, M. D., Guillerme, T., &amp; Smith, M. R. (2019). An algorithm for morphological phylogenetic analysis with inapplicable data. <em>Systematic Biology</em>, <em>68</em>(4), 619–631. doi:<a href="https://doi.org/10.1093/sysbio/syy083">10.1093/sysbio/syy083</a></p>
</div>
<div id="ref-Goloboff1997">
<p>Goloboff, P. A. (1997). Self-weighted optimization: tree searches and character state reconstructions under implied transformation costs. <em>Cladistics</em>, <em>13</em>(3), 225–245. Retrieved from <a href="http://dx.doi.org/10.1111/j.1096-0031.1997.tb00317.x">http://dx.doi.org/10.1111/j.1096-0031.1997.tb00317.x</a></p>
</div>
<div id="ref-Nixon1999">
<p>Nixon, K. C. (1999). The Parsimony Ratchet, a new method for rapid parsimony analysis. <em>Cladistics</em>, <em>15</em>(4), 407–414. doi:<a href="https://doi.org/10.1111/j.1096-0031.1999.tb00277.x">10.1111/j.1096-0031.1999.tb00277.x</a></p>
</div>
<div id="ref-SmithTern">
<p>Smith, M. R. (2019). Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets. <em>Biology Letters</em>, <em>15</em>(2), 20180632. doi:<a href="https://doi.org/10.1098/rsbl.2018.0632">10.1098/rsbl.2018.0632</a></p>
</div>
<div id="ref-Smith2014">
<p>Smith, M. R., &amp; Ortega-Hernández, J. (2014). <em>Hallucigenia</em>’s onychophoran-like claws and the case for Tactopoda. <em>Nature</em>, <em>514</em>(7522), 363–366. doi:<a href="https://doi.org/10.1038/nature13576">10.1038/nature13576</a></p>
</div>
<div id="ref-Vinther2008">
<p>Vinther, J., Van Roy, P., &amp; Briggs, D. E. G. (2008). Machaeridians are Palaeozoic armoured annelids. <em>Nature</em>, <em>451</em>(7175), 185–188. doi:<a href="https://doi.org/10.1038/nature06474">10.1038/nature06474</a></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
