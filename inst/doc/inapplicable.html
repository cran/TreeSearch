<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Martin R. Smith" />

<meta name="date" content="2018-03-08" />

<title>Inapplicable data in morphological phylogenetics</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceLine, a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
div.sourceLine, a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource div.sourceLine, .numberSource a.sourceLine
  { position: relative; }
pre.numberSource div.sourceLine::before, .numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em; }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; color: #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color = initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Inapplicable data in morphological phylogenetics</h1>
<h4 class="author"><em>Martin R. Smith</em></h4>
<h4 class="date"><em>2018-03-08</em></h4>



<p><code>TreeSearch</code> is an R package that allows, among other things, parsimony search on morphological datasets that contain inapplicable data, following the algorithm proposed by Brazeau, Guillerme and Smith <span class="citation">(2017)</span>.</p>
<p>In brief, this algorithm modifies the Fitch algorithm to count the total number of homoplasious events on a tree.</p>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p><a href="getting-started.html">A companion vignette</a> gives details on installing the package and getting up and running.</p>
<p>Once installed, load the inapplicable package into R using</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">library</span>(<span class="st">'TreeSearch'</span>)</div></code></pre>
</div>
<div id="scoring-a-tree-and-conducting-a-tree-search" class="section level2">
<h2>Scoring a tree, and conducting a tree search</h2>
<p>Here’s an example of using the package to conduct tree search. You can <a href="load-data.html">load your own dataset</a>, but for now, we’ll use the Vinther <em>et al.</em> <span class="citation">(2008)</span> dataset that comes bundled with the package.</p>
<p>This dataset is small enough that it runs reasonably quickly, but its phylogenetic signal is obscure enough that it can require Ratchet searches to escape from local optima.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">my.data &lt;-<span class="st"> </span>TreeSearch<span class="op">::</span>inapplicable.datasets[[<span class="st">'Vinther2008'</span>]]</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">my.phyDat &lt;-<span class="st"> </span>phangorn<span class="op">::</span><span class="kw">phyDat</span>(my.data, <span class="dt">type=</span><span class="st">'USER'</span>, <span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">9</span>, <span class="st">'-'</span>))</div></code></pre>
<p>We can generate a random tree and calculate its parsimony score thus:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="co"># Set random seed so that random functions will generate consistent output in this document</span></div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">0</span>)</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">random.tree &lt;-<span class="st"> </span><span class="kw">RandomTree</span>(my.phyDat)</div>
<div class="sourceLine" id="4" href="#4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex=</span><span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></div>
<div class="sourceLine" id="5" href="#5" data-line-number="5"><span class="kw">plot</span>(random.tree)</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">Fitch</span>(random.tree, my.phyDat)</div></code></pre>
<pre><code>## [1] 189</code></pre>
<p>We might save some wasted time in tree search if we can start with a tree that’s a little closer to optimal: perhaps a neighbour-joining tree.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">nj.tree &lt;-<span class="st"> </span><span class="kw">NJTree</span>(my.phyDat)</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex=</span><span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="kw">plot</span>(nj.tree)</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">Fitch</span>(nj.tree, my.phyDat)</div></code></pre>
<pre><code>## [1] 85</code></pre>
<p>With the Vinther <em>et al.</em> <span class="citation">(2008)</span> dataset, nemerteans and brachiopods form an natural outgroup to the other taxa. If we wish, we can constrain this outgroup and avoid making tree rearrangements that would mix ingroup and outgroup taxa. This will accellerate tree search, but it’s worth thinking carefully whether you can be perfectly confident that the ingroup and outgroup are mutually monophyletic.</p>
<p>To constrain an outgroup, we first need to make the outgroup and ingroup monophyletic on our tree:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">outgroup &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'Nemertean'</span>, <span class="st">'Lingula'</span>, <span class="st">'Terebratulina'</span>)</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">rooted.tree &lt;-<span class="st"> </span><span class="kw">EnforceOutgroup</span>(nj.tree, outgroup)</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex=</span><span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></div>
<div class="sourceLine" id="4" href="#4" data-line-number="4"><span class="kw">plot</span>(rooted.tree)</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now let’s see whether a few Nearest-neighbour interchanges can find us a better tree score. This tends to be the quickest search to run, if not the most exhaustive. Using <code>RootedNNISwap</code> instead of <code>NNISwap</code> stops taxa from moving from one side of the root to another, which we need to do if we’re going to enforce our outgroup constraint. Even if we are using a single-taxon outgroup, using <code>RootedNNISwap</code> retains the position of the root, which makes tree comparison and interpretation easier later on.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">better.tree &lt;-<span class="st"> </span><span class="kw">TreeSearch</span>(<span class="dt">tree=</span>rooted.tree, <span class="dt">dataset=</span>my.phyDat, </div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                           <span class="dt">EdgeSwapper=</span>RootedNNISwap, <span class="dt">verbosity=</span><span class="dv">3</span>)</div></code></pre>
<pre><code>## 
##   - Performing tree search.  Initial score: 85
##     - Iteration 6 - Best score 85 hit 1 times
##     - Iteration 7 - Best score 85 hit 2 times
##     - Iteration 8 - Best score 85 hit 3 times
##     - Iteration 10 - Best score 85 hit 4 times
##     - Iteration 11 - Best score 85 hit 5 times
##     - Iteration 12 - Best score 85 hit 6 times
##     - Iteration 16 - Best score 85 hit 7 times
##     - Iteration 17 - Best score 85 hit 8 times
##     - Iteration 19 - Best score 85 hit 9 times
##     - Iteration 24 - Best score 85 hit 10 times
##     - Iteration 29 - Best score 85 hit 11 times
##     - Iteration 36 - Best score 85 hit 12 times
##     * Iteration 37 - New best score 84 found on 1 trees
##     - Iteration 39 - Best score 84 hit 2 times
##     * Iteration 41 - New best score 81 found on 1 trees
##     - Iteration 42 - Best score 81 hit 2 times
##     - Iteration 43 - Best score 81 hit 3 times
##     - Iteration 49 - Best score 81 hit 4 times
##     - Iteration 50 - Best score 81 hit 5 times
##     - Iteration 54 - Best score 81 hit 6 times
##     - Iteration 55 - Best score 81 hit 7 times
##     - Iteration 57 - Best score 81 hit 8 times
##     - Iteration 62 - Best score 81 hit 9 times
##     - Iteration 63 - Best score 81 hit 10 times
##     - Iteration 69 - Best score 81 hit 11 times
##     - Iteration 81 - Best score 81 hit 12 times
##     - Iteration 82 - Best score 81 hit 13 times
##     * Iteration 83 - New best score 80 found on 1 trees
##     - Iteration 84 - Best score 80 hit 2 times
##     - Iteration 85 - Best score 80 hit 3 times
##     - Iteration 89 - Best score 80 hit 4 times
##   - Final score 80 found 4 times after 100 rearrangements</code></pre>
<p>This score is better than the 85 of the original neighbour-joining tree, but is this the best we can do?</p>
<p>Using NNI helps to explore the region of treespace close to the local optimum, but SPR and TBR rearrangements are better at escaping local optima, and find better trees further away in tree space. Using more hits (<code>maxHits</code>) and more iterations (<code>maxIter</code>) also means we’ll move closer to an optimal tree.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">better.tree &lt;-<span class="st"> </span><span class="kw">TreeSearch</span>(better.tree, my.phyDat, <span class="dt">maxHits=</span><span class="dv">8</span>, <span class="dt">maxIter=</span><span class="dv">10000</span>,</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                           <span class="dt">EdgeSwapper=</span>RootedSPRSwap, <span class="dt">verbosity=</span><span class="dv">2</span>)</div></code></pre>
<pre><code>## 
##   - Performing tree search.  Initial score: 80
##   - Final score 80 found 8 times after 440 rearrangements</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">better.tree &lt;-<span class="st"> </span><span class="kw">TreeSearch</span>(better.tree, my.phyDat, <span class="dt">maxHits=</span><span class="dv">20</span>, <span class="dt">maxIter=</span><span class="dv">40000</span>, </div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                           <span class="dt">EdgeSwapper=</span>RootedTBRSwap, <span class="dt">verbosity=</span><span class="dv">2</span>)</div></code></pre>
<pre><code>## 
##   - Performing tree search.  Initial score: 80
##     * Iteration 848 - New best score 79 found on 1 trees
##   - Final score 79 found 20 times after 2046 rearrangements</code></pre>
<p>That score’s looking better, but these are only quick searches, and we could be caught in a local optimum. A more comprehensive search of tree space can be accomplished using the parsimony ratchet <span class="citation">(Nixon, 1999)</span>. It might take a couple of minutes to run.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">best.tree &lt;-<span class="st"> </span><span class="kw">Ratchet</span>(better.tree, my.phyDat, <span class="dt">verbosity=</span><span class="dv">0</span>, <span class="dt">ratchIter=</span><span class="dv">5</span>,</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                     <span class="dt">swappers=</span><span class="kw">list</span>(RootedTBRSwap, RootedSPRSwap, RootedNNISwap))</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="kw">attr</span>(best.tree, <span class="st">'score'</span>) <span class="co"># Each tree is labelled with its score during tree search</span></div></code></pre>
<pre><code>## [1] 79</code></pre>
<p>The best tree for this dataset has a score of 79. This relatively quick Ratchet search always seems to find a tree with this score.</p>
<p>Let’s take a look at the one it’s found on this occasion:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex=</span><span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">plot</span>(best.tree)</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This is, of course, just one most parsimonious tree; with this dataset, there are many.</p>
<p>One way to make a strict consensus of multiple optimal trees is to collect a number of trees from independent Ratchet iterations.</p>
<p>For each Ratchet iteration, we’ll conduct a TBR search to scan tree space, then an NNI search to hone in on the local optimum.</p>
<p>Note that it’s especially important to retain the position of the root here: a single topology, if rooted in different places, can lead to an unresolved consensus.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">my.consensus &lt;-<span class="st"> </span><span class="kw">RatchetConsensus</span>(best.tree, my.phyDat, <span class="dt">swappers=</span></div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                                 <span class="kw">list</span>(RootedTBRSwap, RootedNNISwap))</div></code></pre>
<pre><code>## Found 8 unique trees from 10 searches.</code></pre>
<p>If ten independent runs ended up at a number of different trees, there may be many more optimal trees out there to be found; perhaps we could repeat <code>RatchetConsensus</code> with <code>nSearch = 250</code> for a more exhaustive sampling of tree space. That would take a while though; for now, let’s check out our consensus tree:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="dt">cex=</span><span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">plot</span>(ape<span class="op">::</span><span class="kw">consensus</span>(my.consensus))</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="implied-weighting" class="section level2">
<h2>Implied weighting</h2>
<p>Equal weights produces trees that are less accurate and less precise than implied weights <span class="citation">(Smith, 2017)</span>; equally weighted analysis should never be conducted without also considering the results of implied weights <span class="citation">(Goloboff, 1997)</span>, ideally under a range of concavity constants <span class="citation">(cf. Smith &amp; Ortega-Hernández, 2014)</span>.</p>
<p>The simplest way to conduct an implied weights search is to use the functions</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">IWTreeSearch</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">IWRatchet</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">IWRatchetConsensus</div></code></pre>
<p>which operate in the same fashion as their equally-weighted counterparts, with the option of specifying a concavity constant (<em>k</em>) using the parameter <code>concavity=k</code> (default = 4).</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Brazeau2018">
<p>Brazeau, M. D., Guillerme, T., &amp; Smith, M. R. (2017). Morphological phylogenetic analysis with inapplicable data. <em>Biorxiv</em>. doi:<a href="https://doi.org/10.1101/209775">10.1101/209775</a></p>
</div>
<div id="ref-Goloboff1997">
<p>Goloboff, P. A. (1997). Self-weighted optimization: tree searches and character state reconstructions under implied transformation costs. <em>Cladistics</em>, <em>13</em>(3), 225–245. Retrieved from <a href="http://dx.doi.org/10.1111/j.1096-0031.1997.tb00317.x" class="uri">http://dx.doi.org/10.1111/j.1096-0031.1997.tb00317.x</a></p>
</div>
<div id="ref-Nixon1999">
<p>Nixon, K. C. (1999). The Parsimony Ratchet, a new method for rapid parsimony analysis. <em>Cladistics</em>, <em>15</em>(4), 407–414. doi:<a href="https://doi.org/10.1111/j.1096-0031.1999.tb00277.x">10.1111/j.1096-0031.1999.tb00277.x</a></p>
</div>
<div id="ref-SmithTern">
<p>Smith, M. R. (2017). Quantifying and visualising divergence between pairs of phylogenetic trees. <em>BioRxiv</em>. doi:<a href="https://doi.org/10.1101/227942">10.1101/227942</a></p>
</div>
<div id="ref-Smith2014">
<p>Smith, M. R., &amp; Ortega-Hernández, J. (2014). Hallucigenia’s onychophoran-like claws and the case for Tactopoda. <em>Nature</em>, <em>514</em>(7522), 363–366. doi:<a href="https://doi.org/10.1038/nature13576">10.1038/nature13576</a></p>
</div>
<div id="ref-Vinther2008">
<p>Vinther, J., Van Roy, P., &amp; Briggs, D. E. G. (2008). Machaeridians are Palaeozoic armoured annelids. <em>Nature</em>, <em>451</em>(7175), 185–188. doi:<a href="https://doi.org/10.1038/nature06474">10.1038/nature06474</a></p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
