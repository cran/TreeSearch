<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Martin R. Smith" />

<meta name="date" content="2022-07-25" />

<title>Tree Search with Profile Parsimony</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tree Search with Profile Parsimony</h1>
<h4 class="author">Martin R. Smith</h4>
<h4 class="date">2022-07-25</h4>



<p>Profile Parsimony <span class="citation">(Faith &amp; Trueman,
2001)</span> finds the tree that is most faithful to the information
contained within a given dataset. It is the ‘exact solution’ that
implied weights parsimony approximates. For more information on the
philosophy and mathematics of profile parsimony, see the <a href="profile-scores.html">companion vignette</a>.</p>
<p>Profile Parsimony is currently implemented in “TreeSearch” for
characters with up to two parsimony-informative states. (Further states
are treated as ambiguous, whilst retaining as much information as
possible.)</p>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<!--Duplicated from inapplicable.Rmd-->
<p><a href="getting-started.html">A companion vignette</a> gives details
on installing the package and getting up and running.</p>
<!--
# message=FALSE will suppress message when loading TreeSearch
# Temporary fix until R.oo is updated -- remove thereafter
# https://github.com/r-lib/rlang/issues/669
-->
<p>Once installed, load the inapplicable package into R using</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TreeSearch&quot;</span>)</span></code></pre></div>
<p>In order to reproduce the random elements of this document, set a
random seed:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random seed so that random functions in this document are reproducible</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">RNGversion</span>(<span class="st">&quot;3.5.0&quot;</span>)) <span class="co"># Until we can require R3.6.0</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span></code></pre></div>
</div>
<div id="scoring-a-tree-and-conducting-a-tree-search" class="section level2">
<h2>Scoring a tree, and conducting a tree search</h2>
<p>Here’s an example of using the package to conduct tree search with
profile parsimony. You can <a href="https://ms609.github.io/TreeTools/articles/load-data.html">load
your own dataset</a>, but for this example, we’ll use a simulated
dataset that comes bundled with the <code>TreeSearch</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(congreveLamsdellMatrices)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>myMatrix <span class="ot">&lt;-</span> congreveLamsdellMatrices[[<span class="dv">10</span>]]</span></code></pre></div>
<p>Unless a starting tree is provided, tree search will from a random
addition tree:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>additionTree <span class="ot">&lt;-</span> <span class="fu">AdditionTree</span>(myMatrix, <span class="at">concavity =</span> <span class="st">&quot;profile&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TreeLength</span>(additionTree, myMatrix, <span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 552.6187</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(additionTree)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We could alternatively use a random or neighbour-joining tree:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>randomTree <span class="ot">&lt;-</span> TreeTools<span class="sc">::</span><span class="fu">RandomTree</span>(myMatrix, <span class="at">root =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TreeLength</span>(randomTree, myMatrix, <span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 783.324</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>njTree <span class="ot">&lt;-</span> TreeTools<span class="sc">::</span><span class="fu">NJTree</span>(myMatrix)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TreeLength</span>(njTree, myMatrix, <span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 540.2259</code></pre>
<p>We search for trees with a better score using TBR rearrangements and
the parsimony ratchet <span class="citation">(Nixon, 1999)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>betterTrees <span class="ot">&lt;-</span> <span class="fu">MaximizeParsimony</span>(myMatrix, additionTree, <span class="at">concavity =</span> <span class="st">&quot;profile&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ratchIter =</span> <span class="dv">3</span>, <span class="at">tbrIter =</span> <span class="dv">3</span>, <span class="at">maxHits =</span> <span class="dv">8</span>)</span></code></pre></div>
<p>We’ve used very low values of <code>ratchIter</code>,
<code>tbrIter</code> and <code>maxHits</code> for a rapid run, so this
is not necessarily a thorough enough search to find a globally optimal
tree. Nevertheless, let’s see the resultant tree, and its score:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TreeLength</span>(betterTrees[[<span class="dv">1</span>]], myMatrix, <span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 512.1181</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.75</span>) <span class="co"># make plot easier to read</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ape<span class="sc">::</span><span class="fu">consensus</span>(betterTrees))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The default parameters may not be enough to find the optimal tree;
type <code>?MaximizeParsimony</code> to view all search parameters – or
keep repeating the search until tree score stops improving.</p>
</div>
<div id="view-the-results" class="section level2">
<h2>View the results</h2>
<p>In parsimony search, it is good practice to consider trees that are
slightly suboptimal <span class="citation">(Smith, 2019)</span>.</p>
<p>Here, we’ll take a consensus that includes all trees that are
suboptimal by up to 3 bits. To sample this region of tree space well,
the trick is to use large values of <code>ratchHits</code> and
<code>ratchIter</code>, and small values of <code>searchHits</code> and
<code>searchiter</code>, so that many runs don’t quite hit the optimal
tree. In a serious study, you would want to sample many more than the 3
Ratchet hits (<code>ratchHits</code>) we’ll settle for here, probably
using many more Ratchet iterations.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>suboptimals <span class="ot">&lt;-</span> <span class="fu">MaximizeParsimony</span>(myMatrix, betterTrees, <span class="at">tolerance =</span> <span class="dv">3</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ratchIter =</span> <span class="dv">2</span>, <span class="at">tbrIter =</span> <span class="dv">3</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">maxHits =</span> <span class="dv">25</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">concavity =</span> <span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<p>The consensus of these slightly suboptimal trees provides a less
resolved, but typically more reliable, summary of the signal with the
phylogenetic dataset <span class="citation">(Smith, 2019)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">signif</span>(<span class="fu">TreeLength</span>(suboptimals, myMatrix, <span class="st">&quot;profile&quot;</span>)))</span></code></pre></div>
<pre><code>## 
## 512.118 513.229 513.897 513.966 514.739 514.849 
##       2       1       1       3       1       1</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ape<span class="sc">::</span><span class="fu">consensus</span>(suboptimals))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Faith2001" class="csl-entry">
Faith, D. P., &amp; Trueman, J. W. H. (2001). <span class="nocase">Towards an inclusive philosophy for phylogenetic
inference</span>. <em>Systematic Biology</em>, <em>50</em>(3), 331–350.
doi:<a href="https://doi.org/10.1080/10635150118627">10.1080/10635150118627</a>
</div>
<div id="ref-Nixon1999" class="csl-entry">
Nixon, K. C. (1999). <span class="nocase">The Parsimony Ratchet, a new
method for rapid parsimony analysis</span>. <em>Cladistics</em>,
<em>15</em>(4), 407–414. doi:<a href="https://doi.org/10.1111/j.1096-0031.1999.tb00277.x">10.1111/j.1096-0031.1999.tb00277.x</a>
</div>
<div id="ref-Smith2019" class="csl-entry">
Smith, M. R. (2019). Bayesian and parsimony approaches reconstruct
informative trees from simulated morphological datasets. <em>Biology
Letters</em>, <em>15</em>(2), 20180632. doi:<a href="https://doi.org/10.1098/rsbl.2018.0632">10.1098/rsbl.2018.0632</a>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
